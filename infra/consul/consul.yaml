---
apiVersion: helm.fluxcd.io/v1
kind: HelmRelease
metadata:
  name: consul
  namespace: infra
  annotations:
    fluxcd.io/automated: "true"
    filter.fluxcd.io/chart-image: glob:*
spec:
  releaseName: consul
  chart:
    git: https://github.com./hashicorp/consul-helm
    name: consul
    path: .
    ref: v0.20.1
  values:
    service:
      annotations:
        external-dns.alpha.kubernetes.io/hostname: consul.home.lab
        external-dns.alpha.kubernetes.io/target: traefik.home.lab
    server:
      storageClass: nfs
    ui:
      type: ClusterIP
    syncCatalog:
      enabled: true
      toK8S: false
    replicas: 2
    disruptionBudget:
      enabled: false
